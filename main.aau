import fsys;
import fcgi;
import util.buffer;
import script.aau;
import script.ahtml;

while (fcgi.accept()) {
	util.buffer.beginBuffer();
	try {
		var filename = io.SERVER["SCRIPT_FILENAME"];
		var file = fsys.file(filename, 'r');
		if (!file) {
			error("No input file specified. ", -1);
		}
		file.close();
		script.ahtml.run("webpage", filename);
		webpage = null;
	}
	catch (e) {
		io.stderr.write(e);
	}
	util.buffer.endBuffer();
	collectgarbage("collect");
}